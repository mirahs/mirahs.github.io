window.__require=function t(e,o,r){function n(c,s){if(!o[c]){if(!e[c]){var a=c.split("/");if(a=a[a.length-1],!e[a]){var p="function"==typeof __require&&__require;if(!s&&p)return p(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+c+"'")}c=a}var h=o[c]={exports:{}};e[c][0].call(h.exports,function(t){return n(e[c][1][t]||t)},h,h.exports,t,e,o,r)}return o[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<r.length;c++)n(r[c]);return n}({Chess:[function(t,e,o){"use strict";cc._RF.push(e,"efb1cFVrDxNZrwfKRi0Kk3X","Chess");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.frames=[],e}return n(e,t),Object.defineProperty(e.prototype,"chessName",{get:function(){return this._chessName},enumerable:!1,configurable:!0}),e.prototype.init=function(t){this._chessName=t,this.node.getComponent(cc.Sprite).spriteFrame=this.frames.find(function(e){return e.name==t}),this.redHide()},e.prototype.redShow=function(){this.node.children[0].active=!0},e.prototype.redHide=function(){this.node.children[0].active=!1},i([a([cc.SpriteFrame])],e.prototype,"frames",void 0),i([s],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],Game:[function(t,e,o){"use strict";cc._RF.push(e,"fea23/a1CVA+6ELxQ8C76Yc","Game");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./Chess"),s=cc._decorator,a=s.ccclass,p=s.property,h=[7,7],u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chessPrefab=null,e.bgNode=null,e.rootNode=null,e.chessMap=new Map,e}return n(e,t),e.prototype.onLoad=function(){this.init()},e.prototype.start=function(){this._turn="black",this.drawChess(h[0],h[1]),this.turn()},e.prototype.init=function(){var t=this,e=new cc.Node;e.parent=this.bgNode,e.setAnchorPoint(cc.Vec2.ZERO);var o=e.addComponent(cc.Graphics);o.lineWidth=3,o.strokeColor=cc.Color.RED;for(var r=0;r<15;r++)o.moveTo(25,50*r+25),o.lineTo(725,50*r+25),o.stroke();for(var n=0;n<15;n++)o.moveTo(50*n+25,25),o.lineTo(50*n+25,725),o.stroke();this.rootNode.on(cc.Node.EventType.TOUCH_START,function(e){var o=t.rootNode.convertToNodeSpaceAR(e.getLocation()),r=t.posToGrid(o),n=r[0],i=r[1],c=t.gridToIdx(n,i);t.chessMap.has(c)||(t.drawChess(n,i),t.checkWin(n,i),t.turn())}),this.panelSettleInit()},e.prototype.panelSettleInit=function(){this._panelSettle=this.node.getChildByName("panelSettle"),this._panelSettle.active=!1},e.prototype.panelSettleShow=function(t){this._panelSettle.getChildByName("lblMsg").getComponent(cc.Label).string=t,this._panelSettle.getChildByName("btnOk").on("click",function(){return cc.game.restart()}),this._panelSettle.active=!0},e.prototype.turn=function(){this._turn="black"==this._turn?"white":"black"},e.prototype.drawChess=function(t,e){var o=this.gridToIdx(t,e),r=cc.instantiate(this.chessPrefab);r.parent=this.rootNode,r.setPosition(this.gridToPos(t,e)),this._lastChess&&this._lastChess.redHide();var n=r.getComponent(c.default);n.init(this._turn),n.redShow(),this.chessMap.set(o,n),this._lastChess=n},e.prototype.checkWin=function(t,e){for(var o=[],r=e-4;r<=e+4;r++)o.push(this.chessMap.get(this.gridToIdx(t,r)));if(!this.checkWin2(o)){for(o=[],r=t-4;r<=t+4;r++)o.push(this.chessMap.get(this.gridToIdx(r,e)));if(!this.checkWin2(o)){for(o=[],r=-4;r<=4;r++)o.push(this.chessMap.get(this.gridToIdx(t+r,e+r)));if(!this.checkWin2(o)){for(o=[],r=-4;r<=4;r++)o.push(this.chessMap.get(this.gridToIdx(t-r,e+r)));this.checkWin2(o)||225==this.chessMap.size&&this.panelSettleShow("\u5e73\u5c40")}}}},e.prototype.checkWin2=function(t){for(var e,o,r=0;r<=t.length-4;r++)if((null===(e=t[r])||void 0===e?void 0:e.chessName)==this._turn)for(var n=1,i=r+1;i<t.length&&(null===(o=t[i])||void 0===o?void 0:o.chessName)==this._turn;i++)if(++n>=5){var c="black"==this._turn?"\u9ed1\u68cb\u8d62\u4e86":"\u767d\u68cb\u8d62\u4e86";return this.panelSettleShow(c),!0}return!1},e.prototype.gridToIdx=function(t,e){return t<0||t>=15||e<0||e>=15?-1:15*t+e},e.prototype.gridToPos=function(t,e){return cc.v2(50*e+25,50*t+25)},e.prototype.posToGrid=function(t){return[Math.floor(t.y/50),Math.floor(t.x/50)]},e.prototype.showAll=function(){for(var t=0;t<15;t++)for(var e=0;e<15;e++){var o=cc.instantiate(this.chessPrefab);o.parent=this.rootNode,o.setPosition(this.gridToPos(t,e));var r=1==this.randRange(0,1)?"black":"white";o.getComponent(c.default).init(r)}},e.prototype.randRange=function(t,e){return Math.round(Math.random()*(e-t)+t)},i([p(cc.Prefab)],e.prototype,"chessPrefab",void 0),i([p(cc.Node)],e.prototype,"bgNode",void 0),i([p(cc.Node)],e.prototype,"rootNode",void 0),i([a],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./Chess":"Chess"}]},{},["Chess","Game"]);