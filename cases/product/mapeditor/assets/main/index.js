window.__require=function t(e,n,o){function i(a,s){if(!n[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){return i(e[a][1][t]||t)},u,u.exports,t,e,n,o)}return n[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<o.length;a++)i(o[a]);return i}({AppConstants:[function(t,e,n){"use strict";cc._RF.push(e,"3bd65dH+mFBAqVT4to/3nqE","AppConstants"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.viewLayer={UI:100,Panel:200,Top:900},t.uiShowStyle={Normal:1,FadeIn:2},t.panelShowStyle={Normal:1,CenterSmallToBig:2,UpToCenter:3,DownToCenter:4,LeftToCenter:5,RightToCenter:6,Custom:7},t.panelMaskStyle={NoThrough:1,Black:2,Close:4},t.event={PanelShow:"PanelShow",PanelHide:"PanelHide"},t}();n.default=o,cc._RF.pop()},{}],AppUtil:[function(t,e,n){"use strict";cc._RF.push(e,"175adJDhVlPrbq38ciVatV6","AppUtil");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{c(o.next(t))}catch(e){r(e)}}function s(t){try{c(o.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(){}return t.setWidget=function(t,e,n,o,i,r){if(void 0===e&&(e=null),void 0===n&&(n=0),void 0===o&&(o=0),void 0===i&&(i=0),void 0===r&&(r=0),!t.getComponent(cc.Widget)){var a=t.addComponent(cc.Widget);e&&(a.target=e),a.isAlignTop=!0,a.isAlignBottom=!0,a.isAlignLeft=!0,a.isAlignRight=!0,a.top=n,a.bottom=o,a.left=i,a.right=r}},t.asyncWrap=function(t){return o(this,void 0,Promise,function(){return i(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,t];case 1:return[2,[e.sent(),null]];case 2:return[2,[null,e.sent()]];case 3:return[2]}})})},t.newSpriteNode=function(t){void 0===t&&(t="newSpriteNode");var e=Uint8Array.from([255,255,255,255]),n=new cc.Texture2D;n.initWithData(e,cc.Texture2D.PixelFormat.RGBA8888,1,1);var o=new cc.SpriteFrame;o.setTexture(n);var i=new cc.Node(t),r=i.addComponent(cc.Sprite);return r.sizeMode=cc.Sprite.SizeMode.CUSTOM,r.spriteFrame=o,i.setContentSize(100,100),i},t.storeSet=function(t,e){cc.sys.localStorage.setItem(t,JSON.stringify(e))},t.getClassName=function(t){return(new t).getClassName()},t}();n.default=r,cc._RF.pop()},{}],App:[function(t,e,n){"use strict";cc._RF.push(e,"063f9YA5kFH54H4QH/DDyxe","App"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("./view/LayerMgr"),i=t("./view/PanelMgr"),r=t("./view/UIMgr"),a=function(){function t(){}return t.init=function(t,e){t&&(this._uiMain=t),e&&(this._viewGroup=e),this.initFramework()},t.onSceneLoaded=function(){this.initFramework()},t.showNode=function(t,e,n,o){var i=this;void 0===e&&(e=""),void 0===n&&(n=0),void 0===o&&(o=4),console.log(e+t.name+":"+t.zIndex+":"+t.active),t.childrenCount<=0||++n>=o||t.children.forEach(function(t){return i.showNode(t,e+"\t",n,o)})},t.initFramework=function(){o.default.init(this._viewGroup),r.default.init(this._uiMain),i.default.init()},t._uiMain="UIMain",t._viewGroup="default",t}();n.default=a,cc._RF.pop()},{"./view/LayerMgr":"LayerMgr","./view/PanelMgr":"PanelMgr","./view/UIMgr":"UIMgr"}],AudioMgr:[function(t,e,n){"use strict";cc._RF.push(e,"8f41dcnwL1IK5sMIMShmWqw","AudioMgr");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var r=t("../AppUtil"),a=t("../base/Singleton"),s="app_volume_music",c="app_volume_effect",l="app_enable_music",u="app_enable_effect",p=function(t){function e(){var e=t.call(this)||this;e.musicVolume=1,e.effectVolume=1,e.musicEnable=!0,e.effectEnable=!0,(n=cc.sys.localStorage.getItem(s))&&(e.musicVolume=parseFloat(n)),(n=cc.sys.localStorage.getItem(c))&&(e.effectVolume=parseFloat(n));var n=cc.sys.localStorage.getItem(l);return e.musicEnable="false"!=n,!e.musicEnable&&cc.audioEngine.setMusicVolume(0),n=cc.sys.localStorage.getItem(u),e.effectEnable="false"!=n,!e.effectEnable&&cc.audioEngine.setEffectsVolume(0),cc.game.on(cc.game.EVENT_HIDE,e.pauseAll),cc.game.on(cc.game.EVENT_SHOW,e.resumeAll),e}return i(e,t),Object.defineProperty(e,"inst",{get:function(){return t.getInstance.call(this)},enumerable:!1,configurable:!0}),e.prototype.playMusic=function(t){this.stopMusic(),cc.audioEngine.playMusic(t,!0)},e.prototype.stopMusic=function(){cc.audioEngine.stopMusic()},e.prototype.playEffect=function(t,e){var n=cc.audioEngine.playEffect(t,!1);return e&&cc.audioEngine.setFinishCallback(n,e),n},e.prototype.stopEffect=function(t){cc.audioEngine.stopEffect(t)},e.prototype.getEffectDuration=function(t){return cc.audioEngine.getDuration(t)},e.prototype.getMusicVolume=function(){return this.musicEnable?this.musicVolume:0},e.prototype.setMusicVolume=function(t,e){void 0===e&&(e=!1),(this.musicVolume!=t||e)&&(this.musicVolume=t,cc.audioEngine.setMusicVolume(t),cc.sys.localStorage.setItem(s,t))},e.prototype.getEffectVolume=function(){return this.effectVolume?this.musicVolume:0},e.prototype.setEffectVolume=function(t,e){void 0===e&&(e=!1),(this.effectVolume!=t||e)&&(this.effectVolume=t,cc.audioEngine.setEffectsVolume(t),cc.sys.localStorage.setItem(c,t))},e.prototype.toogleMusicFlag=function(){this.musicEnable=!this.musicEnable,this.musicEnable?cc.audioEngine.setMusicVolume(this.musicVolume):cc.audioEngine.setMusicVolume(0),r.default.storeSet(l,this.musicEnable)},e.prototype.getMusicFlag=function(){return this.musicEnable},e.prototype.toogleEffectFlag=function(){this.effectEnable=!this.effectEnable,this.effectEnable?cc.audioEngine.setEffectsVolume(this.effectVolume):cc.audioEngine.setEffectsVolume(0),r.default.storeSet(u,this.effectEnable)},e.prototype.getEffectFlag=function(){return this.effectEnable},e.prototype.pauseAll=function(){cc.audioEngine.pauseAll()},e.prototype.resumeAll=function(){cc.audioEngine.resumeAll()},e}(a.default);n.default=p,cc._RF.pop()},{"../AppUtil":"AppUtil","../base/Singleton":"Singleton"}],Core:[function(t,e,n){"use strict";cc._RF.push(e,"3adb9T+OwZA6YY8hnJdrLCu","Core");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{c(o.next(t))}catch(e){r(e)}}function s(t){try{c(o.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../framework/scripts/manager/EventMgr"),a=t("../GameConstants"),s=t("./Tip"),c=t("./Wait"),l=function(){function t(){}return t.init=function(){return o(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,s.default.init()];case 1:return t.sent()?[4,c.default.init()]:[2];case 2:return t.sent()?(r.default.emit(a.default.event.CoreLoadOk),[2]):[2]}})})},t}();n.default=l,cc._RF.pop()},{"../../framework/scripts/manager/EventMgr":"EventMgr","../GameConstants":"GameConstants","./Tip":"Tip","./Wait":"Wait"}],Editor:[function(t,e,n){"use strict";cc._RF.push(e,"a00867vcNpJobGFWhyrAu16","Editor");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../framework/scripts/App"),s=t("../../framework/scripts/AppUtil"),c=t("../../framework/scripts/view/PanelMgr"),l=t("../map/MapData"),u=t("../core/Core"),p=t("../util/HtmlUtil"),h=t("../util/MapUtil"),f=t("../view/PanelChoiceDraw"),d=t("../map/MapAction"),y=t("../map/MapInfo"),g=t("../view/PanelMapNew"),w=t("../view/PanelMapOpen"),m=t("../GameConstants"),_=cc._decorator.ccclass,v=function(t,e){this.prefab=t,this.parent=e},M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._drawMap=new Map,e._gridMap=new Map,e._mouseLastDownTime=0,e._polygonPoints=[],e}return i(e,t),e.prototype.onLoad=function(){a.default.init(),u.default.init(),this.init()},e.prototype.start=function(){this.loadMap("load")},e.prototype.init=function(){this.initButton(),this.initMap(),this.initStatus()},e.prototype.initButton=function(){var t=this,e=this.node.getChildByName("top");e.getChildByName("btnNew").on("click",function(){c.default.show(g.default,function(e,n,o,i){y.default.mapFileName=e,y.default.dataFileName=t.mapFileToDataFile(y.default.mapFileName),y.default.gridWidth=o,y.default.gridHeight=i,t.nodeMap.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n),t.loadMap("new")})}),e.getChildByName("btnOpen").on("click",function(){c.default.show(w.default,function(e,n,o,i){y.default.mapFileName=e,y.default.dataFileName=o,y.default.gridWidth=i.grid_width,y.default.gridHeight=i.grid_height,t.nodeMap.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n),t.loadMap("open",i)})}),e.getChildByName("btnSave").on("click",function(){return p.default.saveFile(y.default.dataFileName,t.mapGetData())});var n=e.getChildByName("radioAction").getComponent(cc.ToggleContainer);n.node.getChildByName(y.default.mouseAction).getComponent(cc.Toggle).isChecked=!0,n.checkEvents.push(this.newEventHandler(this.node,"Editor","onRadioAction"));var o=e.getChildByName("btnDrawType");o.children[0].getComponent(cc.Label).string=m.default.mapDrawTypes[y.default.drawType-1][0],o.on(cc.Node.EventType.TOUCH_START,function(){c.default.show(f.default,m.default.mapDrawTypes,function(t){var e=t+1;e!=y.default.drawType&&(y.default.drawType=e,o.children[0].getComponent(cc.Label).string=m.default.mapDrawTypes[t][0])})});var i=e.getChildByName("checkboxGrid").getComponent(cc.Toggle);i.isChecked=y.default.isShowGrid,i.node.on("click",function(e){return t.graphicsGrid.node.active=y.default.isShowGrid=!e.isChecked});var r=e.getChildByName("checkboxPolygon").getComponent(cc.Toggle);r.isChecked=y.default.isShowPolygon,r.node.on("click",function(t){return y.default.isShowPolygon=!t.isChecked})},e.prototype.initMap=function(){this.nodeMap=this.node.getChildByName("middle").getChildByName("map"),this.nodeMap.on(cc.Node.EventType.TOUCH_START,this.onMapTouchStart,this),this.nodeMap.on(cc.Node.EventType.TOUCH_MOVE,this.onMapTouchMove,this),this.nodeMap.on(cc.Node.EventType.MOUSE_WHEEL,this.onMapMouseWheel,this),this.nodeMap.on(cc.Node.EventType.MOUSE_DOWN,this.onMapMouseDown,this)},e.prototype.initStatus=function(){var t=this.node.getChildByName("bottom");this.lblMap=t.getChildByName("lblMap").getComponent(cc.Label),this.lblScale=t.getChildByName("lblScale").getComponent(cc.Label),this.lblPos=t.getChildByName("lblPos").getComponent(cc.Label),this.lblGrid=t.getChildByName("lblGrid").getComponent(cc.Label)},e.prototype.initDrawData=function(){var t;this._drawMap.clear(),this._gridMap.clear();for(var e=0;e<m.default.mapDrawTypes.length;e++){var n=e+1,o=m.default.mapDrawTypes[e],i=n.toString(),r=o[1],a=s.default.newSpriteNode(i);a.setContentSize(y.default.gridWidth-2,y.default.gridHeight-2),a.color=(new cc.Color).fromHEX(r),a.opacity=Number(null!==(t=o[2])&&void 0!==t?t:"255");var c=new cc.Node;c.parent=this.nodeMap,c.setAnchorPoint(cc.Vec2.ZERO),this._drawMap.set(n,new v(a,c))}},e.prototype.initMapGridGraphics=function(){var t=new cc.Node;t.parent=this.nodeMap,t.setAnchorPoint(cc.Vec2.ZERO),this.graphicsGrid=t.addComponent(cc.Graphics),this.graphicsGrid.strokeColor=cc.Color.RED;for(var e=1;e<y.default.rows;e++)this.mapGridDrawCol(e);for(e=1;e<y.default.cols;e++)this.mapGridDrawRow(e)},e.prototype.initMapPloygonGraphics=function(){var t=new cc.Node;t.parent=this.nodeMap,t.setAnchorPoint(cc.Vec2.ZERO),this.graphicsPolygon=t.addComponent(cc.Graphics),this.graphicsPolygon.strokeColor=cc.Color.GREEN},e.prototype.loadMap=function(t,e){this.nodeMap.destroyAllChildren(),this.initDrawData(),this.initMapPloygonGraphics(),"load"!=t&&(this.nodeMap.scale=1,this.nodeMap.setPosition(cc.Vec2.ZERO)),y.default.width=this.nodeMap.width,y.default.height=this.nodeMap.height,y.default.rows=Math.ceil(y.default.width/y.default.gridWidth),y.default.cols=Math.ceil(y.default.height/y.default.gridHeight),this.initMapGridGraphics(),e&&this.loadMapData(e),this.statusShow()},e.prototype.loadMapData=function(t){for(var e=0;e<t.cols;e++)for(var n=0;n<t.rows;n++){var o=t.data[e][n],i=this._drawMap.get(o);if(i){var r=cc.instantiate(i.prefab);r.name=""+o,r.parent=i.parent,r.setPosition(h.default.gridToPos(n,e));var a=h.default.xyToGridText(n,e);this._gridMap.set(a,r)}}},e.prototype.onMapTouchStart=function(t){this.mapTouch(t,!0)},e.prototype.onMapTouchMove=function(t){this.mapTouch(t)},e.prototype.onMapMouseWheel=function(t){var e=this.nodeMap.scale,n=this.nodeMap.getPosition(),o=this.nodeMap.parent.convertToNodeSpaceAR(t.getLocation()),i=this.nodeMap.getPosition().sub(o),r=e;r+=t.getScrollY()>0?.1:-.1,i.mulSelf(r/e);var a=o.add(i);this.nodeMap.scale=r,this.nodeMap.setPosition(a),this.mapCheckBoundary(a.x,a.y)||(this.nodeMap.scale=e,this.nodeMap.setPosition(n)),this.statusShowScale()},e.prototype.onMapMouseDown=function(t){if(y.default.isShowPolygon&&y.default.mouseAction!=d.default.Move){0==this._polygonPoints.length&&this.mapPolygonClearGraphics();var e=this.nodeMap.convertToNodeSpaceAR(t.getLocation()),n=(new Date).getTime();n-this._mouseLastDownTime<300?(this.mapPolygonWork(),this.mapPolygonClear()):(this._mouseLastDownTime=n,this._polygonPoints.push(e),this.mapPolygonDrawCircle(e))}},e.prototype.mapTouch=function(t,e){var n=this.nodeMap.convertToNodeSpaceAR(t.getLocation());if(this.statusShowPosGrid(n),!y.default.isShowPolygon||y.default.mouseAction==d.default.Move)if(e&&this.mapPolygonClearGraphics(),y.default.mouseAction==d.default.Move){var o=t.getDelta();this.mapActionMove(o)}else y.default.mouseAction==d.default.Draw?this.mapActionDraw(n):y.default.mouseAction==d.default.Clear&&this.mapActionClear(n)},e.prototype.mapActionMove=function(t){var e=t.x,n=t.y,o=this.nodeMap.x+e,i=this.nodeMap.y+n;this.nodeMap.setPosition(this.mapFixBoundary(o,i))},e.prototype.mapActionDraw=function(t){var e=h.default.pixelToGridText(t),n=this._drawMap.get(y.default.drawType),o=this._gridMap.get(e);o&&o.name==n.prefab.name||(o&&o.destroy(),(o=cc.instantiate(n.prefab)).parent=n.parent,o.setPosition(h.default.pixelToPos(t)),this._gridMap.set(e,o))},e.prototype.mapActionClear=function(t){var e=h.default.pixelToGridText(t),n=this._gridMap.get(e);n&&(n.destroy(),this._gridMap.delete(e))},e.prototype.mapGridDrawRow=function(t){this.graphicsGrid.moveTo(0,t*y.default.gridHeight),this.graphicsGrid.lineTo(this.nodeMap.width,t*y.default.gridHeight),this.graphicsGrid.stroke()},e.prototype.mapGridDrawCol=function(t){this.graphicsGrid.moveTo(t*y.default.gridWidth,0),this.graphicsGrid.lineTo(t*y.default.gridWidth,this.nodeMap.height),this.graphicsGrid.stroke()},e.prototype.mapPolygonDrawCircle=function(t){if(this.graphicsPolygon.lineWidth=10,this.graphicsPolygon.circle(t.x,t.y,1),this.graphicsPolygon.stroke(),this._polygonPoints.length>=2){var e=this._polygonPoints[this._polygonPoints.length-2];this.mapPolygonDrawLine(t,e)}},e.prototype.mapPolygonDrawLine=function(t,e){this.graphicsPolygon.lineWidth=5,this.graphicsPolygon.moveTo(t.x,t.y),this.graphicsPolygon.lineTo(e.x,e.y),this.graphicsPolygon.stroke()},e.prototype.mapPolygonWork=function(){if(!(this._polygonPoints.length<3)){this.mapPolygonDrawLine(this._polygonPoints[0],this._polygonPoints[this._polygonPoints.length-1]);for(var t=this._polygonPoints[0],e=t.x,n=t.x,o=t.y,i=t.y,r=0,a=this._polygonPoints;r<a.length;r++){var s=a[r];s.x<e&&(e=s.x),s.x>n&&(n=s.x),s.y<o&&(o=s.y),s.y>i&&(i=s.y)}for(var c=h.default.pixelToGrid(cc.v2(e,o)),l=h.default.pixelToGrid(cc.v2(n,i)),u=c.x;u<=l.x;u++)for(var p=c.y;p<=l.y;p++){var f=h.default.gridToPos(u,p);cc.Intersection.pointInPolygon(f,this._polygonPoints)&&(y.default.mouseAction==d.default.Draw?this.mapActionDraw(f):y.default.mouseAction==d.default.Clear&&this.mapActionClear(f))}}},e.prototype.mapPolygonClear=function(){this._mouseLastDownTime=0,this._polygonPoints=[]},e.prototype.mapPolygonClearGraphics=function(){this.mapPolygonClear(),this.graphicsPolygon.clear()},e.prototype.mapGetData=function(){var t=new l.default;t.map_file=y.default.mapFileName,t.width=this.nodeMap.width,t.height=this.nodeMap.height,t.grid_width=y.default.gridWidth,t.grid_height=y.default.gridHeight,t.rows=y.default.rows,t.cols=y.default.cols;for(var e=[],n=0;n<t.cols;n++){e[n]=[];for(var o=0;o<t.rows;o++){var i=0,r=h.default.xyToGridText(o,n),a=this._gridMap.get(r);a&&(i=parseInt(a.name)),e[n][o]=i}}return t.data=e,t},e.prototype.mapFixBoundary=function(t,e){var n=this.nodeMap.scale;return t<-this.nodeMap.width*n+this.nodeMap.parent.width&&(t=-this.nodeMap.width*n+this.nodeMap.parent.width),t>0&&(t=0),e<-this.nodeMap.height*n+this.nodeMap.parent.height&&(e=-this.nodeMap.height*n+this.nodeMap.parent.height),e>0&&(e=0),cc.v2(t,e)},e.prototype.mapCheckBoundary=function(t,e){var n=this.nodeMap.scale;return t>=-this.nodeMap.width*n+this.nodeMap.parent.width&&t<=0&&e>=-this.nodeMap.height*n+this.nodeMap.parent.height&&e<=0},e.prototype.mapFileToDataFile=function(t){return t.substring(0,t.lastIndexOf("."))+".json"},e.prototype.statusShow=function(){this.statusShowMap(),this.statusShowScale(),this.statusShowPosGrid()},e.prototype.statusShowMap=function(){this.lblMap.string="\u5730\u56fe\uff1a"+y.default.mapFileName+", "+y.default.width+"x"+y.default.height+", "+y.default.gridWidth+"x"+y.default.gridHeight+", "+y.default.rows+"x"+y.default.cols},e.prototype.statusShowScale=function(){var t=this.nodeMap.scale.toString().slice(0,3);this.lblScale.string="\u7f29\u653e: "+t},e.prototype.statusShowPosGrid=function(t){void 0===t&&(t=cc.Vec2.ZERO);var e=h.default.pixelToGrid(t);this.lblPos.string="\u5750\u6807\uff1a"+Math.floor(t.x)+"x"+Math.floor(t.y),this.lblGrid.string="\u7f51\u683c\uff1a"+e.x+"x"+e.y},e.prototype.onRadioAction=function(t){y.default.mouseAction=t.node.name},e.prototype.newEventHandler=function(t,e,n){var o=new cc.Component.EventHandler;return o.target=t,o.component=e,o.handler=n,o},r([_],e)}(cc.Component);n.default=M,cc._RF.pop()},{"../../framework/scripts/App":"App","../../framework/scripts/AppUtil":"AppUtil","../../framework/scripts/view/PanelMgr":"PanelMgr","../GameConstants":"GameConstants","../core/Core":"Core","../map/MapAction":"MapAction","../map/MapData":"MapData","../map/MapInfo":"MapInfo","../util/HtmlUtil":"HtmlUtil","../util/MapUtil":"MapUtil","../view/PanelChoiceDraw":"PanelChoiceDraw","../view/PanelMapNew":"PanelMapNew","../view/PanelMapOpen":"PanelMapOpen"}],EventMgr:[function(t,e,n){"use strict";cc._RF.push(e,"c2779N8KfFKKqQ1YKrcicli","EventMgr"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("../AppConstants"),i=function(){function t(){}return t.on=function(t,e,n){this._events.has(t)?this._events.get(t).push({cb:e,ctx:n}):this._events.set(t,[{cb:e,ctx:n}])},t.off=function(t,e,n){if(this._events.has(t)){var o=this._events.get(t).findIndex(function(t){return e===t.cb&&t.ctx===n});o>=0&&this._events.get(t).splice(o,1)}else console.error("EventMgr.off event["+t+"]\u672a\u6ce8\u518c")},t.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._events.has(t)?this._events.get(t).forEach(function(t){var n=t.cb,o=t.ctx;n.apply(o,e)}):t!=o.default.event.PanelShow&&t!=o.default.event.PanelHide&&console.error("EventMgr.emit event["+t+"] \u672a\u6ce8\u518c")},t.clear=function(t){t&&this._events.forEach(function(e){for(var n=e.length-1;n>=0;n--)e[n].ctx==t&&e.splice(n,1)})},t._events=new Map,t}();n.default=i,cc._RF.pop()},{"../AppConstants":"AppConstants"}],GameConstants:[function(t,e,n){"use strict";cc._RF.push(e,"5b4b7pwYlRAv7o/dcoh2iqe","GameConstants"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.event={CoreLoadOk:"CoreLoadOk"},t.mapDrawTypes=[["\u53ef\u884c\u8d70","#FFFF00"],["\u534a\u900f\u660e","#FFFF00","100"]],t}();n.default=o,cc._RF.pop()},{}],HtmlUtil:[function(t,e,n){"use strict";cc._RF.push(e,"3e7a3jBdRhBlZyNggMlJuER","HtmlUtil"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.getInputFile=function(t,e,n){void 0===e&&(e="");var o=document.getElementById(t);return o||((o=document.createElement("input")).id=t,o.type="file",o.accept=e,o.style.display="none",n&&(o.onchange=n),document.body.appendChild(o),o)},t.saveFile=function(t,e){var n=document.createElement("a");n.download=t,n.innerHTML="Save File",n.style.display="none";var o=JSON.stringify(e),i=new Blob([o]);n.href=window.URL.createObjectURL(i),n.onclick=function(){document.body.removeChild(n)},document.body.appendChild(n),n.click()},t.openLink=function(t){var e=document.createElement("a");e.setAttribute("href",t),e.setAttribute("target","_blank"),e.style.display="none",e.onclick=function(){document.body.removeChild(e)},document.body.appendChild(e),e.click()},t}();n.default=o,cc._RF.pop()},{}],HttpMgr:[function(t,e,n){"use strict";cc._RF.push(e,"6eed3IUL3ND8aQjyUSpQ7S1","HttpMgr"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.get=function(t,e,n){return this.request(t,"GET",e,n)},t.post=function(t,e,n){return this.request(t,"POST",e,n)},t.put=function(t,e,n){return this.request(t,"PUT",e,n)},t.patch=function(t,e,n){return this.request(t,"PATCH",e,n)},t.delete=function(t,e,n){return this.request(t,"DELETE",e,n)},t.request=function(t,e,n,o){var i=this;return new Promise(function(r,a){var s=cc.loader.getXMLHttpRequest();s.timeout=1e4,s.ontimeout=function(){a("\u8bf7\u6c42\u8d85\u65f6")},s.onerror=function(){a("onerror url:"+t+",statusText:"+s.statusText)},s.onreadystatechange=function(){if(4==s.readyState){var t=s.responseText;if(t)if(o)try{r(JSON.parse(t))}catch(e){a(e)}else r(t);else r(t)}};var c=i.args2HttpParams(n);"GET"==e?(t=""==c?t:t+"?"+c,s.open(e,t,!0),s.send()):(s.open(e,t,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(c))})},t.args2HttpParams=function(t){if(!t)return"";var e="";for(var n in t){var o=t[n];if(Array.isArray(o))for(var i=0,r=o;i<r.length;i++)e+=n+"="+r[i]+"&";else e+=n+"="+o+"&"}return e.substring(0,e.length-1)},t}();n.default=o,cc._RF.pop()},{}],LayerMgr:[function(t,e,n){"use strict";cc._RF.push(e,"be8d7jMIjtAsJ1enFzADBKk","LayerMgr"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("../AppConstants"),i=t("../AppUtil"),r=function(){function t(){}return t.init=function(t){for(var e in this.viewGroup=t,this._layerMap.clear(),o.default.viewLayer){var n=o.default.viewLayer[e];this.newLayer(e,n)}},t.newLayer=function(t,e){var n=cc.Canvas.instance.node.getChildByName(t);n||((n=new cc.Node(t)).parent=cc.Canvas.instance.node,n.group=this.viewGroup,n.zIndex=e,i.default.setWidget(n),this._layerMap.set(e,n))},t.setLayer=function(t,e){var n=this._layerMap.get(e);n?(t.parent||(t.parent=n),t.zIndex=this._zIndex++):console.error("LayerMgr.setLayer layer["+e+"] \u4e0d\u5b58\u5728")},t._layerMap=new Map,t._zIndex=0,t}();n.default=r,cc._RF.pop()},{"../AppConstants":"AppConstants","../AppUtil":"AppUtil"}],MapAction:[function(t,e,n){"use strict";var o;cc._RF.push(e,"e86dfApHcJJCLPUyJW1dNxH","MapAction"),Object.defineProperty(n,"__esModule",{value:!0}),function(t){t.Move="move",t.Clear="clear",t.Draw="draw"}(o||(o={})),n.default=o,cc._RF.pop()},{}],MapData:[function(t,e,n){"use strict";cc._RF.push(e,"f06a09EZq9H1Jy/O3jv7OeJ","MapData"),Object.defineProperty(n,"__esModule",{value:!0});n.default=function(){},cc._RF.pop()},{}],MapInfo:[function(t,e,n){"use strict";cc._RF.push(e,"7a45cNYZwVBAoUl1NIZ1Sys","MapInfo"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("./MapAction"),i=function(){function t(){}return t.mapFileName="map.jpg",t.dataFileName="map.json",t.gridWidth=40,t.gridHeight=40,t.mouseAction=o.default.Move,t.drawType=1,t.isShowPolygon=!1,t.isShowGrid=!0,t}();n.default=i,cc._RF.pop()},{"./MapAction":"MapAction"}],MapUtil:[function(t,e,n){"use strict";cc._RF.push(e,"3c251CRF4xIopwMK5tL9tjs","MapUtil"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("../map/MapInfo"),i=function(){function t(){}return t.pixelToGrid=function(t){var e=Math.floor(t.x/o.default.gridWidth),n=Math.floor(t.y/o.default.gridHeight);return cc.v2(e,n)},t.gridToPos=function(t,e){return cc.v2(t*o.default.gridWidth+o.default.gridWidth/2,e*o.default.gridHeight+o.default.gridHeight/2)},t.pixelToPos=function(t){var e=this.pixelToGrid(t);return this.gridToPos(e.x,e.y)},t.pixelToGridText=function(t){var e=this.pixelToGrid(t);return this.xyToGridText(e.x,e.y)},t.xyToGridText=function(t,e){return t+"_ "+e},t}();n.default=i,cc._RF.pop()},{"../map/MapInfo":"MapInfo"}],MaskProgressComp:[function(t,e,n){"use strict";cc._RF.push(e,"89c2eXXzf9IibF9NrNmHD2a","MaskProgressComp");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.TextProgress=n.Direction=void 0;var a,s,c=cc._decorator,l=c.ccclass,u=c.property,p=c.menu;(function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"})(a=n.Direction||(n.Direction={})),function(t){t[t.TYPE1=0]="TYPE1",t[t.TYPE2=1]="TYPE2"}(s=n.TextProgress||(n.TextProgress={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.direction=a.HORIZONTAL,e.mask=null,e.lblProgress=null,e.textProgress=s.TYPE1,e.iconFolowed=null,e._progress=0,e}return i(e,t),Object.defineProperty(e.prototype,"progress",{get:function(){return this._progress},set:function(t){this._progress=t,this.direction==a.VERTICAL?(this.mask.height=Math.floor(t*this.node.height),this.iconFolowed&&(this.iconFolowed.y=this.mask.y+this.mask.height)):(this.mask.width=Math.floor(t*this.node.width),this.iconFolowed&&(this.iconFolowed.x=this.mask.x+this.mask.width)),this.lblProgress&&(this.textProgress==s.TYPE1?this.lblProgress.string="\u52a0\u8f7d\u4e2d... "+Math.round(100*t)+"%":this.lblProgress.string=Math.round(100*t)+"%")},enumerable:!1,configurable:!0}),e.prototype.setProgress=function(t){this._progressTween&&(this._progressTween.stop(),this._progress=null),this.progress=this.checkProgress(t)},e.prototype.updateProgress=function(t){this._progressTween&&this._progressTween.stop(),this._progressTween=cc.tween(this).to(1,{progress:this.checkProgress(t)}).start()},e.prototype.checkProgress=function(t){return t=Math.max(t,0),Math.min(t,1)},r([u({type:cc.Enum(a)})],e.prototype,"direction",void 0),r([u(cc.Node)],e.prototype,"mask",void 0),r([u(cc.Label)],e.prototype,"lblProgress",void 0),r([u({type:cc.Enum(s)})],e.prototype,"textProgress",void 0),r([u(cc.Node)],e.prototype,"iconFolowed",void 0),r([l,p("UI/MaskProgressComp")],e)}(cc.Component);n.default=h,cc._RF.pop()},{}],PanelBase:[function(t,e,n){"use strict";cc._RF.push(e,"c91eei7jz5E5KBWlfnVlcT8","PanelBase");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var r=t("../AppConstants"),a=t("./PanelMgr"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.panelShowStyle=r.default.panelShowStyle.Normal,e.panelMaskStyle=r.default.panelMaskStyle.NoThrough,e.duration=.2,e.blackMaskDuration=.1,e}return i(e,t),e.prototype.close=function(){a.default.hide(this.panelName)},e.prototype.closeImmediate=function(){a.default.destroy(this.panelName)},e}(t("./ViewBase").default);n.default=s,cc._RF.pop()},{"../AppConstants":"AppConstants","./PanelMgr":"PanelMgr","./ViewBase":"ViewBase"}],PanelChoiceDraw:[function(t,e,n){"use strict";cc._RF.push(e,"591fdjncwhMsZzJg2c1Sa15","PanelChoiceDraw");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../framework/scripts/AppConstants"),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bundleName="null",e.skinPath="_panels/PanelChoiceDraw",e.panelMaskStyle=r.default.panelMaskStyle.NoThrough|r.default.panelMaskStyle.Black,e}return i(e,t),e.prototype.onInitDone=function(){for(var t,e=this,n=this.skin.getChildByName("items").children[0],o=this._args[0],i=function(i){var r=o[i],a=r[0],s=r[1],c=cc.instantiate(n);c.name=a,c.color=(new cc.Color).fromHEX(s),c.opacity=Number(null!==(t=r[2])&&void 0!==t?t:"255"),c.children[0].getComponent(cc.Label).string=a,c.parent=n.parent,c.on(cc.Node.EventType.TOUCH_START,function(){e._args[1](i),e.close()})},r=0;r<o.length;r++)i(r);n.destroy()},e}(t("../../framework/scripts/view/PanelBase").default);n.default=a,cc._RF.pop()},{"../../framework/scripts/AppConstants":"AppConstants","../../framework/scripts/view/PanelBase":"PanelBase"}],PanelMapNew:[function(t,e,n){"use strict";cc._RF.push(e,"32679M4TCNCTYTZZMxWL1r6","PanelMapNew");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../framework/scripts/AppConstants"),a=t("../../framework/scripts/view/PanelBase"),s=t("../core/Tip"),c=t("../util/HtmlUtil"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bundleName="null",e.skinPath="_panels/PanelMapNew",e.panelMaskStyle=r.default.panelMaskStyle.NoThrough|r.default.panelMaskStyle.Black,e}return i(e,t),e.prototype.onInitDone=function(){var t=this;this.fileMapInput=c.default.getInputFile("mapEditor-file_map_new","image/jpeg,image/jpg,image/png"),this.fileMapInput.onchange=function(){var e=t.fileMapInput.files;!e||e.length<=0||(t.fileMap=e[0],t.lblMapFile.string=t.fileMap.name)},this.lblMapFile=this.skin.getChildByName("spriteMapFile").getChildByName("lblMapFile").getComponent(cc.Label)},e.prototype.onButtonClick=function(t){"BtnOpenFile"==t.name?this.fileMapInput.click():"BtnCancel"==t.name?this.close():"BtnConfirm"==t.name&&this.onClickBtnConfirm()},e.prototype.onDestroy=function(){this.fileMapInput.onchange=null,this.fileMapInput.value=""},e.prototype.onClickBtnConfirm=function(){var t=this;if(this.fileMap){var e=this.skin.getChildByName("editGridWidth").getComponent(cc.EditBox),n=this.skin.getChildByName("editGridHeight").getComponent(cc.EditBox),o=e.string?Number(e.string):40,i=n.string?Number(n.string):40;if(o<30||o>100)s.default.show("\u7f51\u683c\u5bbd\u5ea6 [30, 100]");else if(i<30||i>100)s.default.show("\u7f51\u683c\u9ad8\u5ea6 [30, 100]");else{var r=new FileReader;r.onload=function(){var e=new Image;e.src=r.result,e.onload=function(){var n=new cc.Texture2D;n.initWithElement(e),t._args[0](t.fileMap.name,n,o,i),t.close()}},r.readAsDataURL(this.fileMap)}}else s.default.show("\u8bf7\u9009\u62e9\u5730\u56fe\u6587\u4ef6")},e}(a.default);n.default=l,cc._RF.pop()},{"../../framework/scripts/AppConstants":"AppConstants","../../framework/scripts/view/PanelBase":"PanelBase","../core/Tip":"Tip","../util/HtmlUtil":"HtmlUtil"}],PanelMapOpen:[function(t,e,n){"use strict";cc._RF.push(e,"5c452ytq0pKH4d0YJNtQT6I","PanelMapOpen");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../framework/scripts/AppConstants"),a=t("../../framework/scripts/view/PanelBase"),s=t("../core/Tip"),c=t("../util/HtmlUtil"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bundleName="null",e.skinPath="_panels/PanelMapOpen",e.panelMaskStyle=r.default.panelMaskStyle.NoThrough|r.default.panelMaskStyle.Black,e}return i(e,t),e.prototype.onInitDone=function(){var t=this;this.fileMapInput=c.default.getInputFile("mapEditor-file_open_map","image/jpeg,image/jpg,image/png"),this.fileMapInput.onchange=function(){var e=t.fileMapInput.files;!e||e.length<=0||(t.fileMap=e[0],t.lblMapFile.string=t.fileMap.name)},this.lblMapFile=this.skin.getChildByName("spriteMapFile").getChildByName("lblMapFile").getComponent(cc.Label),this.fileDataInput=c.default.getInputFile("mapEditor-file_open_data",".json"),this.fileDataInput.onchange=function(){var e=t.fileDataInput.files;!e||e.length<=0||(t.fileData=e[0],t.lblDataFile.string=t.fileData.name)},this.lblDataFile=this.skin.getChildByName("spriteDataFile").getChildByName("lblDataFile").getComponent(cc.Label)},e.prototype.onButtonClick=function(t){"BtnOpenFile"==t.name?this.fileMapInput.click():"BtnOpenData"==t.name?this.fileDataInput.click():"BtnCancel"==t.name?this.close():"BtnConfirm"==t.name&&this.onClickBtnConfirm()},e.prototype.onDestroy=function(){this.fileMapInput.onchange=null,this.fileMapInput.value="",this.fileDataInput.onchange=null,this.fileDataInput.value=""},e.prototype.onClickBtnConfirm=function(){var t=this;if(this.fileMap&&this.fileData){var e=new FileReader;e.onload=function(){var n=new Image;n.src=e.result,n.onload=function(){var e=new FileReader;e.onload=function(){var o=JSON.parse(e.result);if(n.width==o.width&&n.height==o.height){var i=new cc.Texture2D;i.initWithElement(n),t._args[0](t.fileMap.name,i,t.fileData.name,o),t.close()}else cc.error("\u5730\u56fe "+t.fileMap.name+" \u7684\u5bbd\u9ad8\u548c\u5730\u56fe\u6587\u4ef6 "+t.fileData.name+" \u7684\u5bbd\u5ea6\u4e0d\u4e00\u81f4")},e.readAsText(t.fileData)}},e.readAsDataURL(this.fileMap)}else s.default.show("\u8bf7\u9009\u62e9\u5730\u56fe\u548c\u6570\u636e\u6587\u4ef6")},e}(a.default);n.default=l,cc._RF.pop()},{"../../framework/scripts/AppConstants":"AppConstants","../../framework/scripts/view/PanelBase":"PanelBase","../core/Tip":"Tip","../util/HtmlUtil":"HtmlUtil"}],PanelMgr:[function(t,e,n){"use strict";cc._RF.push(e,"b4419ROtQdNkqhIDK5+VE9d","PanelMgr");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{c(o.next(t))}catch(e){r(e)}}function s(t){try{c(o.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../AppConstants"),a=t("../AppUtil"),s=t("../manager/EventMgr"),c=t("../manager/ResMgr"),l=t("./LayerMgr"),u=t("./TopBlock"),p=function(){function t(){}return t.init=function(){this._panels.clear(),this._maskPrefab&&this._maskPrefab.isValid||(this._maskPrefab=a.default.newSpriteNode(this._maskName),this._maskPrefab.color=cc.Color.BLACK,this._maskPrefab.opacity=0)},t.show=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return o(this,void 0,void 0,function(){var n,o,s,p,h,f,d;return i(this,function(i){switch(i.label){case 0:return u.default.show(),n=new t,o=n.getClassName(),(s=this._panels.get(o))?[3,4]:((s=n).panelName=o,p=void 0,"null"!=s.bundleName?[3,1]:(f=cc.find(s.skinPath,cc.Canvas.instance.node))?(p=cc.instantiate(f),[3,3]):(u.default.hide(),console.error("PanelMgr.show cc.find \u627e\u4e0d\u5230["+o+"]\u9762\u677f\u573a\u666f\u5bf9\u8c61:"+s.skinPath),[2]));case 1:return[4,a.default.asyncWrap(c.default.load(s.bundleName,s.skinPath))];case 2:if(h=i.sent(),f=h[0],d=h[1])return u.default.hide(),console.error("PanelMgr.show load bundleName:"+s.bundleName+",skinPath:"+s.skinPath+",err:"+d),[2];p=cc.instantiate(f),i.label=3;case 3:return s.init(e),s.skin=p,s.initDone(),l.default.setLayer(s.skin,r.default.viewLayer.Panel),this.maskStyle(s),this._panels.set(o,s),[3,5];case 4:s.reset(e),l.default.setLayer(s.skin,r.default.viewLayer.Panel),i.label=5;case 5:return s.skin.active=!1,s.showing(),this.startShowPanel(s,s.panelShowStyle,!0),[2]}})})},t.isAlive=function(t){var e=a.default.getClassName(t);return this._panels.has(e)&&this._panels.get(e).skin.active},t.updateView=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var o=a.default.getClassName(t);this.isAlive(t)?this._panels.get(o).updateView(e):console.error("PanelMgr.updateView [%s] \u66f4\u65b0 view \u5931\u8d25, \u672a\u6253\u5f00\u6216\u672a\u6fc0\u6d3b",o)},t.hide=function(t){if(this._panels.has(t)){var e=this._panels.get(t);e.skin.active?(u.default.show(),this.startShowPanel(e,e.panelShowStyle,!1)):console.error("PanelMgr.hide \u9762\u677f["+t+"]\u5df2\u9690\u85cf")}else console.error("PanelMgr.hide \u9762\u677f["+t+"]\u4e0d\u5b58\u5728")},t.hideAll=function(){var t=this;this._panels.forEach(function(e){e.skin.active&&t.destroy(e.panelName)}),s.default.emit(r.default.event.PanelHide)},t.destroy=function(t,e){if(void 0===e&&(e=!1),this._panels.has(t)){var n=this._panels.get(t);n.hiding(),n.skin.active=!1,n.hided(),!e&&n.cache||(this._panels.delete(t),n.destroy(),n=null)}else console.error("PanelMgr.destroy \u9762\u677f["+t+"]\u4e0d\u5b58\u5728")},t.maskStyle=function(t){var e=this,n=cc.instantiate(this._maskPrefab);t.skin.addChild(n,-1),a.default.setWidget(n,t.skin.parent),(t.panelMaskStyle&r.default.panelMaskStyle.NoThrough)>0&&n.addComponent(cc.BlockInputEvents),(t.panelMaskStyle&r.default.panelMaskStyle.Close)>0&&(n.getComponent(cc.BlockInputEvents)||n.addComponent(cc.BlockInputEvents),n.on(cc.Node.EventType.TOUCH_START,function(o){for(var i=o.getLocation(),r=0,a=t.skin.children;r<a.length;r++){var s=a[r];if(s!=n&&s.getBoundingBoxToWorld().contains(i))return}e.hide(t.panelName)}))},t.startShowPanel=function(t,e,n){switch(e){case r.default.panelShowStyle.Normal:this.showNormal(t,n);break;case r.default.panelShowStyle.CenterSmallToBig:this.showCenterScale(t,n);break;case r.default.panelShowStyle.LeftToCenter:this.showSideToCenter(t,cc.v3(-cc.winSize.width,0,0),n);break;case r.default.panelShowStyle.RightToCenter:this.showSideToCenter(t,cc.v3(cc.winSize.width,0,0),n);break;case r.default.panelShowStyle.UpToCenter:this.showSideToCenter(t,cc.v3(0,cc.winSize.height,0),n);break;case r.default.panelShowStyle.DownToCenter:this.showSideToCenter(t,cc.v3(0,-cc.winSize.height,0),n);break;case r.default.panelShowStyle.Custom:n&&!t.tweenShow?this.showNormal(t,n):n||t.tweenHide?this.showCustom(t,n):this.showNormal(t,n);break;default:console.error("PanelMgr.startShowPanel showStyle \u9519\u8bef:"+e)}},t.showNormal=function(t,e){this.showPanelBefore(t,e),e?(t.skin.active=!0,t.showed()):this.destroy(t.panelName),this.showPanelAfter(t,e)},t.showCenterScale=function(t,e){var n=this;this.showPanelBefore(t,e),e?(t.skin.scale=0,t.skin.active=!0,cc.tween(t.skin).to(t.duration,{scale:1},t.easingShow).call(function(){t.showed(),n.showPanelAfter(t,e)}).start()):cc.tween(t.skin).to(t.duration,{scale:0},t.easingHide).call(function(){n.destroy(t.panelName),n.showPanelAfter(t,e)}).start()},t.showSideToCenter=function(t,e,n){var o=this;this.showPanelBefore(t,n);var i=cc.Vec3.ZERO;n?(t.skin.setPosition(e),t.skin.active=!0,cc.tween(t.skin).to(t.duration,{position:i},t.easingShow).call(function(){t.showed(),o.showPanelAfter(t,n)}).start()):cc.tween(t.skin).to(t.duration,{position:e},t.easingHide).call(function(){o.destroy(t.panelName),o.showPanelAfter(t,n)}).start()},t.showCustom=function(t,e){var n=this;this.showPanelBefore(t,e),e?(t.skin.active=!0,t.tweenShow.call(function(){t.showed(),n.showPanelAfter(t,e)}).start()):t.tweenHide.call(function(){n.destroy(t.panelName),n.showPanelAfter(t,e)}).start()},t.showPanelBefore=function(t,e){!e&&(t.panelMaskStyle&r.default.panelMaskStyle.Black)>0&&(t.skin.getChildByName(this._maskName).opacity=0)},t.showPanelAfter=function(t,e){var n=this,o=t.skin.getChildByName(this._maskName);o.setPosition(cc.Vec2.ZERO),e&&(t.panelMaskStyle&r.default.panelMaskStyle.Black)>0?t.blackMaskDuration<=0?(o.opacity=125,this.showPanelAfter2(e)):cc.tween(o).to(t.blackMaskDuration,{opacity:125}).call(function(){return n.showPanelAfter2(e)}).start():this.showPanelAfter2(e)},t.showPanelAfter2=function(t){if(u.default.hide(),t)s.default.emit(r.default.event.PanelShow);else{var e=!0;this._panels.forEach(function(t){t.skin.active&&(e=!1)}),e&&s.default.emit(r.default.event.PanelHide)}},t._panels=new Map,t._maskName="_mask",t}();n.default=p,cc._RF.pop()},{"../AppConstants":"AppConstants","../AppUtil":"AppUtil","../manager/EventMgr":"EventMgr","../manager/ResMgr":"ResMgr","./LayerMgr":"LayerMgr","./TopBlock":"TopBlock"}],PolygonButtonComp:[function(t,e,n){"use strict";cc._RF.push(e,"6dc27YyB+tGMatfcsmPg7A1","PolygonButtonComp");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.menu,l=a.requireComponent,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isTouchStart=!1,e._isBig=!1,e}return i(e,t),e.prototype.onLoad=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(e){return t.onTouchStart(e)}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){return t.onTouchMove(e)}),this.node.on(cc.Node.EventType.TOUCH_END,function(e){return t.onTouchEnd(e)}),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){return t.onTouchCancel()})},e.prototype.setClickCallback=function(t){this.cb=t},e.prototype.onTouchStart=function(t){this.checkClick(t.getLocation())&&(this._isTouchStart=!0,this._isBig=!0,cc.tween(this.node).to(.1,{scale:1.1}).start())},e.prototype.onTouchMove=function(t){if(this._isTouchStart){var e=this.checkClick(t.getLocation());e&&!this._isBig?(this._isBig=!0,cc.tween(this.node).to(.1,{scale:1.1}).start()):!e&&this._isBig&&(this._isBig=!1,cc.tween(this.node).to(.1,{scale:1}).start())}},e.prototype.onTouchEnd=function(t){if(this._isTouchStart){this._isTouchStart=!1;var e=this.checkClick(t.getLocation());(e||this._isBig)&&(e&&this.cb&&this.cb(this.node),this._isBig&&(this._isBig=!1,cc.tween(this.node).to(.1,{scale:1}).start()))}},e.prototype.onTouchCancel=function(){this._isTouchStart&&(this._isTouchStart=!1,this._isBig&&(this._isBig=!1,cc.tween(this.node).to(.1,{scale:1}).start()))},e.prototype.checkClick=function(t){var e=this.node.convertToNodeSpaceAR(t),n=this.node.getComponent(cc.PolygonCollider).points;return cc.Intersection.pointInPolygon(e,n)},r([s,l(cc.PolygonCollider),c("UI/PolygonButtonComp")],e)}(cc.Component);n.default=u,cc._RF.pop()},{}],ResMgr:[function(t,e,n){"use strict";cc._RF.push(e,"89230V/kXhG1IFci6O39CVw","ResMgr"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.load=function(t,e){return t?this.loadBundleRes(t,e):this.loadRes(e)},t.loadRemote=function(t){return new Promise(function(e,n){cc.assetManager.loadRemote(t,function(t,o){t?n(t):e(o)})})},t.loadBundle=function(t){return new Promise(function(e,n){var o=cc.assetManager.getBundle(t);o?e(o):cc.assetManager.loadBundle(t,function(t,o){t?n(t):e(o)})})},t.loadBundleRes=function(t,e,n){var o=this;return new Promise(function(i,r){o.loadBundle(t).then(function(t){t.load(e,n,function(t,e){t?r(t):i(e)})}).catch(function(t){r(t)})})},t.loadBundleResDir=function(t,e,n){var o=this;return new Promise(function(i,r){o.loadBundle(t).then(function(t){t.loadDir(e,n,function(t,e){t?r(t):i(e)})}).catch(function(t){r(t)})})},t.loadBundleResArray=function(t,e,n){var o=this;return new Promise(function(i,r){o.loadBundle(t).then(function(t){t.load(e,n,function(t,e){t?r(t):i(e)})}).catch(function(t){r(t)})})},t.loadRes=function(t,e){return new Promise(function(n,o){cc.resources.load(t,e,function(t,e){t?o(t):n(e)})})},t.loadResDir=function(t,e){return new Promise(function(n,o){cc.resources.loadDir(t,e,function(t,e){t?o(t):n(e)})})},t.loadResArray=function(t,e){return new Promise(function(n,o){cc.resources.load(t,e,function(t,e){t?o(t):n(e)})})},t}();n.default=o,cc._RF.pop()},{}],Singleton:[function(t,e,n){"use strict";cc._RF.push(e,"92f27txO41GrohHVRGGnVGw","Singleton"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new this),this._instance},t}();n.default=o,cc._RF.pop()},{}],SpriteFrameComp:[function(t,e,n){"use strict";cc._RF.push(e,"526057UeMJCa70JbyCcFYjQ","SpriteFrameComp");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=a.menu,u=a.requireComponent,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.frames=[],e}return i(e,t),e.prototype.setFrame=function(t){var e=this.frames.find(function(e){return e.name==t});e&&(this.node.getComponent(cc.Sprite).spriteFrame=e)},e.prototype.setFrameByIndex=function(t){t<0||t>=this.frames.length||(this.node.getComponent(cc.Sprite).spriteFrame=this.frames[t])},r([c([cc.SpriteFrame])],e.prototype,"frames",void 0),r([s,u(cc.Sprite),l("UI/SpriteFrameComp")],e)}(cc.Component);n.default=p,cc._RF.pop()},{}],StateMachine:[function(t,e,n){"use strict";cc._RF.push(e,"3ddceKu6GRKMas2SE38t4wj","StateMachine"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("./State"),i=function(){function t(t){this._stateMap=new Map,this._owner=t}return t.prototype.register=function(t){this._owner==t.owner?this._stateMap.set(t.getStateKey(),t):console.error("StateMachine.register owner \u4e0d\u4e00\u81f4")},t.prototype.enter=function(t,e){var n=this._stateMap.get(t);n?this._currentState?this._currentState.getStateKey()==t?n.onReEnter(e):(this._currentState.onExit(n.getStateKey()),n.onEnter(e,this._currentState.getStateKey()),this._currentState=n):(n.onEnter(e),this._currentState=n):console.error("StateMachine.enter \u4e0d\u5b58\u5728 state:"+t)},t.prototype.update=function(t){this._currentState&&this._currentState.onUpdate(t)},t.prototype.getCurrentStateKey=function(){return this._currentState?this._currentState.getStateKey():o.default.invalidState},t.prototype.clear=function(){this._currentState&&this._currentState.onExit(o.default.invalidState),this._owner=null,this._stateMap.clear(),this._stateMap=null,this._currentState=null},t}();n.default=i,cc._RF.pop()},{"./State":"State"}],State:[function(t,e,n){"use strict";cc._RF.push(e,"1effc+VANxI/azQut2/GYIp","State"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t){this._owner=t}return Object.defineProperty(t.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),t.prototype.onEnter=function(){},t.prototype.onReEnter=function(){},t.prototype.onUpdate=function(){},t.prototype.onExit=function(){},t.prototype.getStateKey=function(){return t.invalidState},t.invalidState="invalid",t}();n.default=o,cc._RF.pop()},{}],TimerMgr:[function(t,e,n){"use strict";cc._RF.push(e,"8b49bWwkV5LwpPb15jo4l+U","TimerMgr");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var r=function(t){function e(){var e=t.call(this)||this;return e._timers=[],cc.director.on(cc.Director.EVENT_BEFORE_UPDATE,e.update,e),e}return i(e,t),Object.defineProperty(e,"inst",{get:function(){return t.getInstance.call(this)},enumerable:!1,configurable:!0}),e.prototype.add=function(t,e,n,o,i){void 0===o&&(o=1),null!=e?this.exist(e,n,i)?cc.error("TimerMgr.add \u5b9a\u65f6\u5668\u5df2\u5b58\u5728"):this._timers.push({tick:0,interval:t,cb:e,ctx:n,repeat:o,key:i}):cc.error("TimerMgr.add \u53c2\u6570\u9519\u8bef")},e.prototype.del=function(t,e,n){var o=this._timers.findIndex(function(o){return t===o.cb&&o.ctx===e&&o.key===n});o>=0&&this._timers.splice(o,1)},e.prototype.clear=function(t){if(t)for(var e=this._timers.length-1;e>=0;e--)this._timers[e].ctx==t&&this._timers.splice(e,1)},e.prototype.update=function(){for(var t=cc.director.getDeltaTime(),e=this._timers.length-1;e>=0;e--){var n=this._timers[e];n.tick+=1e3*t,n.tick<n.interval||(n.tick-=n.interval,n.repeat<=0?0==n.interval?n.cb.call(n.ctx,t):n.cb.call(n.ctx,n.key):(n.repeat--,0==n.repeat&&this._timers.splice(e,1),n.cb.call(n.ctx,n.key)))}},e.prototype.exist=function(t,e,n){return this._timers.findIndex(function(o){return t===o.cb&&o.ctx===e&&o.key===n})>=0},e}(t("../base/Singleton").default);n.default=r,cc._RF.pop()},{"../base/Singleton":"Singleton"}],Tip:[function(t,e,n){"use strict";cc._RF.push(e,"1c125YPpJtKI44F3Tp++H8H","Tip");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{c(o.next(t))}catch(e){r(e)}}function s(t){try{c(o.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../framework/scripts/AppConstants"),a=t("../../framework/scripts/AppUtil"),s=t("../../framework/scripts/manager/ResMgr"),c=t("../../framework/scripts/view/LayerMgr"),l=function(){function t(){}return t.init=function(){return o(this,void 0,void 0,function(){var t,e,n;return i(this,function(o){switch(o.label){case 0:return this._prefab?[2,!0]:[4,a.default.asyncWrap(s.default.loadRes("core/Tip"))];case 1:return t=o.sent(),e=t[0],(n=t[1])?(console.error("Tip.init \u627e\u4e0d\u5230\u8d44\u6e90 [core/Tip] error:"+n),[2,!1]):(this._prefab=e,[2,!0])}})})},t.show=function(t){this._view&&this._view.isValid||(this._view=cc.instantiate(this._prefab),this._view.opacity=0,c.default.setLayer(this._view,r.default.viewLayer.Top)),this._view.getChildByName("lblTip").getComponent(cc.Label).string=t,this._view.y=0,this._view.stopAllActions(),cc.tween(this._view).show().to(.2,{opacity:255}).delay(2).to(.5,{opacity:0,y:100}).hide().start()},t}();n.default=l,cc._RF.pop()},{"../../framework/scripts/AppConstants":"AppConstants","../../framework/scripts/AppUtil":"AppUtil","../../framework/scripts/manager/ResMgr":"ResMgr","../../framework/scripts/view/LayerMgr":"LayerMgr"}],TopBlock:[function(t,e,n){"use strict";cc._RF.push(e,"76626yk2dpI/ozEFXRSaML4","TopBlock"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("../AppConstants"),i=t("../AppUtil"),r=t("./LayerMgr"),a=function(){function t(){}return t.show=function(){this.ensure(),r.default.setLayer(this._view,o.default.viewLayer.Top),this._view.active=!0},t.hide=function(){this._view&&this._view.isValid&&(this._view.active=!1)},t.ensure=function(){this._view&&this._view.isValid||(this._view=new cc.Node("TopBlock"),this._view.opacity=0,i.default.setWidget(this._view),this._view.addComponent(cc.BlockInputEvents))},t}();n.default=a,cc._RF.pop()},{"../AppConstants":"AppConstants","../AppUtil":"AppUtil","./LayerMgr":"LayerMgr"}],UIBase:[function(t,e,n){"use strict";cc._RF.push(e,"cca73ZQ1PFGPrGQ/8nWli4m","UIBase");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var r=t("../AppConstants"),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.uiShowStyle=r.default.uiShowStyle.Normal,e.duration=.5,e}return i(e,t),e}(t("./ViewBase").default);n.default=a,cc._RF.pop()},{"../AppConstants":"AppConstants","./ViewBase":"ViewBase"}],UIMgr:[function(t,e,n){"use strict";cc._RF.push(e,"ff5eeVEAy5IGYgbR1VUKaui","UIMgr");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{c(o.next(t))}catch(e){r(e)}}function s(t){try{c(o.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./LayerMgr"),a=t("../AppUtil"),s=t("../AppConstants"),c=t("../manager/ResMgr"),l=t("./TopBlock"),u=function(t,e){this.uiCls=t,this.args=e},p=function(){function t(){}return t.init=function(t){this._uis.clear(),this._uiMain=t,this._uiOpens=[]},t.open=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var o=new t,i=o.getClassName();this._current&&this._current.uiName==i?console.error("UIMgr.open \u5df2\u5728\u5f53\u524dUI:"+i):(this._isOpen=!0,this._openData=new u(t,e),this.show(o,e))},t.back=function(){if(this._uiOpens.length<2)console.error("UIMgr.back \u6570\u636e\u9519\u8bef");else{this._isOpen=!1;var t=this._uiOpens[this._uiOpens.length-2];this.show(new t.uiCls,t.args)}},t.isAlive=function(t){var e=a.default.getClassName(t);return null!=this._current&&e==this._current.uiName},t.updateView=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return!!this.isAlive(t)&&(this._current.updateView(e),!0)},t.show=function(t,e){return o(this,void 0,void 0,function(){var n,o,r,s,u,p;return i(this,function(i){switch(i.label){case 0:return l.default.show(),n=t.getClassName(),(o=this._uis.get(n))?[3,4]:((o=t).uiName=n,r=void 0,"null"!=o.bundleName?[3,1]:(u=cc.find(o.skinPath,cc.Canvas.instance.node))?(r=cc.instantiate(u),u.active=!1,[3,3]):(l.default.hide(),console.error("UIMgr.show cc.find \u627e\u4e0d\u5230["+n+"]\u9762\u677f\u573a\u666f\u5bf9\u8c61:"+o.skinPath),[2]));case 1:return[4,a.default.asyncWrap(c.default.load(o.bundleName,o.skinPath))];case 2:if(s=i.sent(),u=s[0],p=s[1])return l.default.hide(),console.error("UIMgr.show loadRes skinPath:"+o.skinPath+" err:"+p),[2];r=cc.instantiate(u),i.label=3;case 3:return o.init(e),o.skin=r,o.initDone(),[3,5];case 4:o.reset(e),i.label=5;case 5:return this.startShowUI(o),[2]}})})},t.startShowUI=function(t){if(t.showing(),a.default.setWidget(t.skin),r.default.setLayer(t.skin,s.default.viewLayer.UI),t.uiShowStyle==s.default.uiShowStyle.Normal||!this._current||t.duration<=0)this.showNormal(t);else switch(t.uiShowStyle){case s.default.uiShowStyle.FadeIn:this.showFadeIn(t);break;default:console.error("UIMgr.startShowUI uiShowStyle \u9519\u8bef:"+t.uiShowStyle)}},t.hideLast=function(t){var e=this,n=this._current;n&&(this._current=null,n.hiding(),t?cc.tween(n.skin).to(t,{opacity:0}).call(function(){return e.hideUI(n)}).start():this.hideUI(n))},t.hideUI=function(t){t.skin.active=!1,t.hided(),t.cache||(this._uis.delete(t.uiName),t.destroy())},t.showUIAfter=function(t){l.default.hide(),this._current=t,this._uis.has(t.uiName)||this._uis.set(t.uiName,t),this._isOpen?(this._uiMain==t.uiName&&(this._uiOpens=[]),this._uiOpens.push(this._openData)):this._isOpen||this._uiOpens.splice(this._uiOpens.length-1,1)},t.showNormal=function(t){t.skin.opacity=255,t.skin.active=!0,t.showed(),this.hideLast(),this.showUIAfter(t)},t.showFadeIn=function(t){var e=this;t.skin.opacity=0,t.skin.active=!0,this.hideLast(t.duration),cc.tween(t.skin).to(t.duration,{opacity:255}).call(function(){t.showed(),e.showUIAfter(t)}).start()},t._uis=new Map,t._uiOpens=[],t}();n.default=p,cc._RF.pop()},{"../AppConstants":"AppConstants","../AppUtil":"AppUtil","../manager/ResMgr":"ResMgr","./LayerMgr":"LayerMgr","./TopBlock":"TopBlock"}],ViewBase:[function(t,e,n){"use strict";cc._RF.push(e,"83a87dhoAZFa6AlfPqlx/iu","ViewBase"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){this.cache=!1,this._args=[]}return t.prototype.getClassName=function(){return this.skinPath.split("/").slice(-1)[0]},t.prototype.init=function(t){this._args=t,this.onInit()},t.prototype.initDone=function(){for(var t=this,e=function(e){if(!e.node.name.startsWith("Btn"))return"continue";e.node.on("click",function(){t.onButtonClick(e.node)})},n=0,o=this.skin.getComponentsInChildren(cc.Button);n<o.length;n++)e(o[n]);this.onInitDone()},t.prototype.reset=function(t){this._args=t,this.onReset()},t.prototype.showing=function(){this.onShowing()},t.prototype.showed=function(){this.onShowed()},t.prototype.updateView=function(t){this.onUpdateView(t)},t.prototype.hiding=function(){this.onHiding()},t.prototype.hided=function(){this.onHided()},t.prototype.destroy=function(){this.onDestroy(),this.skin.destroy()},t.prototype.onInit=function(){},t.prototype.onInitDone=function(){},t.prototype.onReset=function(){},t.prototype.onButtonClick=function(){},t.prototype.onShowing=function(){},t.prototype.onShowed=function(){},t.prototype.onUpdateView=function(){},t.prototype.onHiding=function(){},t.prototype.onHided=function(){},t.prototype.onDestroy=function(){},t}();n.default=o,cc._RF.pop()},{}],Wait:[function(t,e,n){"use strict";cc._RF.push(e,"a6877LTj0lNVLWlB+rUp/gP","Wait");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{c(o.next(t))}catch(e){r(e)}}function s(t){try{c(o.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../framework/scripts/AppConstants"),a=t("../../framework/scripts/AppUtil"),s=t("../../framework/scripts/manager/ResMgr"),c=t("../../framework/scripts/view/LayerMgr"),l=function(){function t(){}return t.init=function(){return o(this,void 0,void 0,function(){var t,e,n;return i(this,function(o){switch(o.label){case 0:return this._prefab?[2,!0]:[4,a.default.asyncWrap(s.default.loadRes("core/Wait"))];case 1:return t=o.sent(),e=t[0],(n=t[1])?(console.error("Wait.init \u627e\u4e0d\u5230\u8d44\u6e90 [core/Wait] error:"+n),[2,!1]):(this._prefab=e,[2,!0])}})})},t.show=function(){this.action(!0)},t.hide=function(){this.action(!1)},t.action=function(t){if(!this._view||!this._view.isValid){this._view=cc.instantiate(this._prefab),a.default.setWidget(this._view),this._view.addComponent(cc.BlockInputEvents);var e=this._view.getChildByName("wait");cc.tween(e).repeatForever(cc.tween().to(.75,{angle:-360}).call(function(){return e.angle=0})).start()}c.default.setLayer(this._view,r.default.viewLayer.Top),this._view.active=t},t}();n.default=l,cc._RF.pop()},{"../../framework/scripts/AppConstants":"AppConstants","../../framework/scripts/AppUtil":"AppUtil","../../framework/scripts/manager/ResMgr":"ResMgr","../../framework/scripts/view/LayerMgr":"LayerMgr"}]},{},["App","AppConstants","AppUtil","Singleton","MaskProgressComp","PolygonButtonComp","SpriteFrameComp","AudioMgr","EventMgr","HttpMgr","ResMgr","TimerMgr","State","StateMachine","LayerMgr","PanelBase","PanelMgr","TopBlock","UIBase","UIMgr","ViewBase","GameConstants","Core","Tip","Wait","MapAction","MapData","MapInfo","Editor","HtmlUtil","MapUtil","PanelChoiceDraw","PanelMapNew","PanelMapOpen"]);